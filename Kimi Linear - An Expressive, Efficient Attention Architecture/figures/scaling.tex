\pgfdeclareplotmark{redstar}{
    \node[star,star point ratio=2.25,minimum size=6pt,
          inner sep=0pt,draw=black,solid,fill=brickred!80] {};
}
\pgfdeclareplotmark{bluestar}{
    \node[star,star point ratio=2.25,minimum size=6pt,
          inner sep=0pt,draw=black,solid,fill=midnightblue!80] {};
}


\begin{table}[t!]
    \centering
    \small
    \renewcommand{\arraystretch}{1.1}
    \begin{threeparttable}
    \caption{
    Model configurations and hyperparameters for scaling law experiments. 
    }
    \setlength{\tabcolsep}{7pt}
    \label{tab:scaling_params}
    \begin{tabular}{cccccccc}
        \toprule
        \# Act. Params.\tnote{$\dagger$} & Head & Layer & Hidden & Tokens & lr & batch size\tnote{$\ddagger$} \\
        \midrule
        653M  & 16 & 16 & 1216 & \textcolor{white}{0}38.8B & $2.006\times 10^{-3}$ & 336 \\
        878M  & 18 & 18 & 1376 & \textcolor{white}{0}59.8B & $1.790\times 10^{-3}$ & 432 \\
        1.1B  & 20 & 20 & 1536 & \textcolor{white}{0}85.2B & $1.617\times 10^{-3}$ & 512 \\
        1.4B  & 22 & 22 & 1632 & 102.5B                    & $1.486\times 10^{-3}$ & 576 \\
        1.7B  & 24 & 24 & 1776 & 128.0B                    & $1.371\times 10^{-3}$ & 640 \\
        \bottomrule
    \end{tabular}
    \begin{tablenotes}
        \small
        \item[$\dagger$] Denotes the number of activated parameters in our MoE models, excluding embeddings.
        \item[$\ddagger$] All models were trained with a context length of 4,096.
    \end{tablenotes}
\end{threeparttable}
\end{table}

\begin{figure}[t!]
    \centering
    \small 
    \resizebox{0.5\textwidth}{!}{
    \begin{tikzpicture}
        \begin{axis}[
            xmode=log,
            ymode=log,
            log ticks with fixed point,
            x filter/.code=\pgfmathparse{#1},
            xlabel={PFLOP/s-days},
            ylabel style={at={(0.5,0.0)}},
            ylabel={Loss},
            ylabel style={at={(0.05,0.5)}},
            xmin=1.3,
            xmax=18,
            ymin=1.96,
            ymax=2.27,
            xtick={1, 10},
            xticklabels={{$10^0$}, {$10^1$}}, 
            ytick={2.0, 2.1, 2.2},
            yticklabels={$2.0$, $2.1$, $2.2$}, 
            width=9cm, height=8cm,
            scaled y ticks=false,
            grid=both,
            legend style={ at={(1,1)}, anchor=north east, legend cell align=left, font=\scriptsize, },
        ]
            \addplot[midnightblue!80, dashed, line width=1.2pt, domain=1.3:18]  {
            2.30919 * exp(-0.05364 * ln(x))
            };
            \addlegendentry{MLA: $2.3092 \times C^{-0.0536}$}

            \addplot[brickred!80, dashed, line width=1.2pt, domain=1.3:18] {
            2.28789 * exp(-0.05265 * ln(x))
            };
            \addlegendentry{Kimi Linear: $2.2879 \times C^{-0.0527}$}

            \addplot[color=brickred!80, only marks, mark=redstar]
            coordinates { 
            (1.7561361621634257, 2.2256522972637383)
            (3.6389031312011673, 2.130743119369714)
            (6.761923198438021, 2.066681874261965)
            (9.873512038478644, 2.030533820622505)
            (15.437117088796946, 1.9826816360711195)
            };

            \addplot[color=midnightblue!80, only marks, mark=bluestar] coordinates
            { 
            (1.697379395880878, 2.249736827606759)
            (3.498749644306514, 2.1514321567048675)
            (6.4511332473629, 2.0874647828148913)
            (9.386512491492146, 2.0503538819031504)
            (14.583615044168363, 2.002056205240299)
            };
            \draw [->, thick, black] (axis cs:5.0841580520520635, 2.1) --  (axis cs:5.880916850890163, 2.1)
                node[
                    midway,   
                    xshift=30pt,
                    above=5pt,
                    sloped,     
                    font=\small,
                    black       
                ] 
                {\large$1.16 \times$};
        \end{axis}
    \end{tikzpicture}
    }
    \caption{The fitted scaling law curves for MLA and Kimi Linear. 
    }
    \label{fig:scaling_law}
\end{figure}